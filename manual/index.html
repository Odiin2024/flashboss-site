<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashBoss Manual</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="../icon.png">
    <style>
        /* Book layout for tutorial splash */
        .book-section {
            min-height: calc(100vh - 200px);
            display: flex;
            flex-direction: column;
        }

        .book-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            flex: 1;
            background: var(--bg-card);
            border-radius: 8px;
            overflow: hidden;
        }

        /* Left page - navigation tree */
        .book-left {
            padding: 1.5rem;
            border-right: 2px solid var(--coral);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* Horizontal navigation flow: parent -> focus */
        .nav-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .nav-arrow {
            color: var(--coral);
            font-size: 1.2rem;
        }

        /* Parent thumbnails */
        .parent-thumb {
            width: 50px;
            height: 55px;
            background: var(--bg-dark);
            border: 2px solid var(--grey);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.45rem;
            color: var(--grey);
            text-decoration: none;
            cursor: pointer;
            transition: border-color 0.2s, transform 0.2s;
            overflow: hidden;
        }

        .parent-thumb:hover {
            border-color: var(--coral);
            transform: scale(1.05);
        }

        .parent-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Main/focus page display */
        .focus-thumb {
            width: 120px;
            height: 130px;
            background: var(--bg-dark);
            border: 3px solid var(--moon-yellow);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--moon-cream);
            font-family: var(--font-pixel);
            font-size: 0.55rem;
            text-align: center;
            padding: 0.5rem;
            overflow: hidden;
            text-decoration: none;
            cursor: pointer;
            transition: border-color 0.2s, transform 0.2s;
        }

        .focus-thumb:hover {
            border-color: var(--coral);
            transform: scale(1.02);
        }

        .focus-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 2px;
        }

        /* Child thumbnails */
        .nav-children {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            justify-content: center;
            margin-top: 0.5rem;
        }

        .child-thumb {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            text-decoration: none;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .child-thumb:hover {
            transform: translateY(-2px);
        }

        .child-thumb .menu-num {
            font-family: var(--font-pixel);
            font-size: 0.6rem;
            color: var(--coral);
        }

        .child-thumb .thumb-box {
            width: 45px;
            height: 50px;
            background: var(--bg-dark);
            border: 2px solid var(--link-blue);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.4rem;
            color: var(--grey);
            overflow: hidden;
        }

        .child-thumb:hover .thumb-box {
            border-color: var(--moon-yellow);
        }

        .child-thumb .thumb-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .child-thumb .thumb-label {
            font-size: 0.6rem;
            color: var(--grey);
            max-width: 55px;
            text-align: center;
            line-height: 1.2;
        }

        /* Right page - description */
        .book-right {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .book-right h2 {
            font-family: var(--font-pixel);
            font-size: 0.9rem;
            color: var(--moon-yellow);
            border: none;
            margin-bottom: 1rem;
        }

        .book-right p {
            color: var(--moon-cream);
            line-height: 1.8;
            margin-bottom: 1rem;
        }

        .book-right .hint {
            font-size: 0.85rem;
            color: var(--grey);
            font-style: italic;
        }

        /* Mobile: stack vertically */
        @media (max-width: 768px) {
            .book-layout {
                grid-template-columns: 1fr;
            }

            .book-left {
                border-right: none;
                border-bottom: 2px solid var(--coral);
            }

            .nav-flow {
                flex-direction: row;
                gap: 0.5rem;
            }

            .focus-thumb {
                width: 100px;
                height: 110px;
            }

            .parent-thumb {
                width: 40px;
                height: 45px;
            }
        }

        /* Chapter grid section heading */
        .chapters-heading {
            font-family: var(--font-pixel);
            font-size: 0.9rem;
            text-align: center;
            margin: 3rem 0 1.5rem;
            color: var(--moon-yellow);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>FlashBoss Manual</h1>
            <p class="tagline">scientia est potentia</p>
        </header>

        <!-- Book layout tutorial splash -->
        <section class="book-section">
            <div class="book-layout">
                <!-- Left page: navigation tree (rendered by JS) -->
                <div class="book-left" id="cladogramLeft">
                    <div class="nav-flow" id="navFlow"></div>
                    <div class="nav-children" id="navChildren"></div>
                </div>

                <!-- Right page: description (rendered by JS) -->
                <div class="book-right" id="cladogramRight">
                    <h2 id="focusTitle">Loading...</h2>
                    <div id="focusDescription"></div>
                    <p class="hint">Click a parent or child to shift focus. Click the focus image to open that page.</p>
                </div>
            </div>
        </section>

        <!-- Chapter grid - alternative entry point -->
        <h3 class="chapters-heading">Quick Reference</h3>

        <div class="chapter-grid">
            <div class="chapter-card">
                <a href="getting-started.html">
                    <h3>Getting Started</h3>
                    <p>Installation, first launch, and creating your hero</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="masters.html">
                    <h3>Meet the Masters</h3>
                    <p>Choose your guide: Luna, Claude, Odiin, Shen, Kitsune, or Aquila</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="daily-practice.html">
                    <h3>Daily Practice</h3>
                    <p>Streaks, card reviews, and maintaining your progress</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="lessons.html">
                    <h3>Lessons</h3>
                    <p>Learning new vocabulary through guided lessons</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="boss-fights.html">
                    <h3>Boss Fights</h3>
                    <p>Challenge cluster bosses to unlock new content</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="grimoire.html">
                    <h3>The Grimoire</h3>
                    <p>Powerdrive sessions and earning Drive</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="tiers.html">
                    <h3>Tiers &amp; Clusters</h3>
                    <p>Advancing through vocabulary tiers and defeating cluster bosses</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="language-packs.html">
                    <h3>Language Packs</h3>
                    <p>German Core, Esperanto, and DLC content</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="tier-skip.html">
                    <h3>Tier Skip Challenge</h3>
                    <p>Test out of content you already know</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="review-modes.html">
                    <h3>Review Modes</h3>
                    <p>Different ways to review and practice your cards</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="terminal-commands.html">
                    <h3>Terminal Commands</h3>
                    <p>Command reference for advanced users</p>
                </a>
            </div>

            <div class="chapter-card">
                <a href="faq.html">
                    <h3>FAQ</h3>
                    <p>Frequently asked questions</p>
                </a>
            </div>
        </div>

        <footer>
            <p><a href="../home.html">Back to FlashBoss Home</a></p>
            <p>&copy; 2025 FlashBoss</p>
        </footer>
    </div>

    <script>
        let screens = {};
        let currentFocus = 'profile-select';

        // Load screen data
        fetch('screens.json')
            .then(response => response.json())
            .then(data => {
                screens = data;
                renderCladogram();
            })
            .catch(err => {
                console.error('Failed to load screens.json:', err);
                document.getElementById('focusTitle').textContent = 'Error loading data';
            });

        function renderCladogram() {
            const focus = screens[currentFocus];
            if (!focus) return;

            // Render navigation flow (parents -> focus)
            const navFlow = document.getElementById('navFlow');
            navFlow.innerHTML = '';

            // Add parents
            focus.parents.forEach((parentId, index) => {
                const parent = screens[parentId];
                if (!parent) return;

                const parentEl = document.createElement('div');
                parentEl.className = 'parent-thumb';
                parentEl.onclick = () => setFocus(parentId);

                if (parent.image) {
                    parentEl.innerHTML = `<img src="${parent.image}" alt="${parent.title}">`;
                } else {
                    parentEl.textContent = parent.title;
                }
                navFlow.appendChild(parentEl);

                // Add arrow after parent
                const arrow = document.createElement('span');
                arrow.className = 'nav-arrow';
                arrow.innerHTML = '&rarr;';
                navFlow.appendChild(arrow);
            });

            // Add focus
            const focusEl = document.createElement('a');
            focusEl.className = 'focus-thumb';
            focusEl.href = focus.page;
            if (focus.image) {
                focusEl.innerHTML = `<img src="${focus.image}" alt="${focus.title}">`;
            } else {
                focusEl.textContent = focus.title;
            }
            navFlow.appendChild(focusEl);

            // Render children
            const navChildren = document.getElementById('navChildren');
            navChildren.innerHTML = '';

            focus.children.forEach(childId => {
                const child = screens[childId];
                if (!child) return;

                const childEl = document.createElement('div');
                childEl.className = 'child-thumb';
                childEl.onclick = () => setFocus(childId);

                // Get menu number label if exists
                const menuNum = focus.childLabels ? focus.childLabels[childId] : '';

                let thumbContent;
                if (child.image) {
                    thumbContent = `<img src="${child.image}" alt="${child.title}">`;
                } else {
                    thumbContent = child.title.substring(0, 8);
                }

                childEl.innerHTML = `
                    <span class="menu-num">${menuNum}</span>
                    <div class="thumb-box">${thumbContent}</div>
                    <span class="thumb-label">${child.title}</span>
                `;
                navChildren.appendChild(childEl);
            });

            // Render description
            document.getElementById('focusTitle').textContent = focus.title;

            const descDiv = document.getElementById('focusDescription');
            descDiv.innerHTML = '';
            focus.description.split('\n\n').forEach(para => {
                const p = document.createElement('p');
                p.textContent = para;
                descDiv.appendChild(p);
            });
        }

        function setFocus(screenId) {
            if (screens[screenId]) {
                currentFocus = screenId;
                renderCladogram();
            }
        }
    </script>
</body>
</html>
